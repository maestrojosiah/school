<div class="panel panel-default">
    <div class="panel-heading">
        Exam Summary for 
		       <select class="form-inline" id="term">
          <option value="none" {% if term == "none" %} selected {% endif %}>Choose Term</option>
            <option value="term_1" {% if term == 1 %} selected {% endif %}>Term 1</option>
            <option value="term_2" {% if term == 2 %} selected {% endif %}>Term 2</option>
            <option value="term_3" {% if term == 3 %} selected {% endif %}>Term 3</option>
        </select>
      {{ dump(rank)}}
     <select class="form-inline" id="examCompany">
          <option value="select_one" {% if examCompany == null %} selected {% endif %} disabled >Select Exam Company</option>
          {% for company in examCompanies %}
            <option value="{{ company.id }}" {% if examCompany != null and examCompany.id == company.id %} selected {% endif %}>{{ company.companyName }}</option>
          {% endfor %}
      </select>
      {% if class != null and examCompany != null %}
      	<a href="{{ path('add_exam_page', {'classId': class.id, 'examCompanyId': examCompany.id, 'term': term }) }}" class="btn btn-default">Edit Records</a>
  	  {% endif %}
    </div>
		{# marks, company etc.. #}
    <div class="panel-body">
        <div class="table-responsive">
            <table class="table table-hover"  id="dataTables-example">
                <thead>
                    <tr>
                        <th class="col-md-3 text-center">Name</th>
                        {% for subject in subjects %}
                        	<th class="col-md-1 text-center">{{ subject.subjectTitle }}</th>
                    	{% endfor %}
                    	<th class="col-md-1 text-info text-center">Totals</th>
                    </tr>
                </thead>
                <tbody>
                	{% for student in students %}
                		<tr>
                			<td><span class="text-nowrap"><a href="{{ path('student_profile', { studentId: student.id } ) }}">{{ student }}</a></span></td>
                            {% for subject in subjects %}
	                      		{% set key = student.id ~ subject.id %}
	                        	{% if exam[key] is defined %}
		                          	{% set marks = exam[key].marks %}
		                        {% else %}
		                          	{% set marks = null %}
	                        	{% endif %}
                            	<td class="text-center">{{ marks }}</td>
                        	{% endfor %}
                        	<td class="text-info text-center"><strong>{{ totalMarksStudent[student.id] }}</strong></td>
                		</tr>
                	{% endfor %}
                </tbody>
                <tbody>
                    <tr>
                        <td class="text-info"><strong>Totals</strong></td>
                        {% set sumTotalMarksSubject = 0 %}
                        {% for subject in subjects %}
                            {% set sumTotalMarksSubject = sumTotalMarksSubject + totalMarksSubject[subject.id] %}
                            <td class="text-info text-center"><strong>{{ totalMarksSubject[subject.id] }}</strong></td>
                        {% endfor %}
                        <td class="text-info text-center"><strong>{{ sumTotalMarksSubject }}</strong></td>
                    </tr>
                    <tr>
                        <td class="text-primary"><strong>Mean Score</strong></td>
                        {% for subject in subjects %}
                        {% set meanScore = totalMarksSubject[subject.id] / students|length %}
                            <td class="text-primary text-center"><strong>{{ meanScore|round(2) }}</strong></td>
                        {% endfor %}
                        {% set totalMarksMean = sumTotalMarksSubject / students|length %}
                        <td class="text-info text-center"><strong>{{ totalMarksMean|round(2) }}</strong></td>
                    </tr>

                </tbody>
            </table>
        </div>
    </div>

</div>
<a id="redirect" href="{{ path('view_exams', {'classId': class.id, 'examCompanyId': 'new', 'term': 'none' }) }}"></a>
{# set per page, position for students and subjects #}